<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" data-bs-theme="dark" lang="en">
<head>
    <meta charset = "ISO-8859-1" />
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

    <title>Chat Sync Application</title>
    <!--  for bootstrap fonts -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <!-- for fontawesome icons-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link href="/ChatSync/webjars/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="/ChatSync/webjars/jquery/jquery.min.js"></script>
    <script src="/ChatSync/webjars/sockjs-client/sockjs.min.js"></script>
    <script src="/ChatSync/webjars/stomp-websocket/stomp.min.js"></script>

    <link rel="stylesheet" th:href="@{/css/main.css}">

    <script type="text/javascript" th:src="@{/js/api_utils.js}"></script>
    <script type="text/javascript" th:src="@{/js/html_components.js}"></script>
    <script type="text/javascript" th:src="@{/js/common_utils.js}"></script>
    <script type="text/javascript" th:src="@{/js/contacts.js}"></script>

</head>
<body>
<th:block th:include="header :: header"></th:block>
<div class="container">
    <!-- list of contacts section -->
    <div id="contacts-list">
        <div class="row">
            <div class="col-12">
                <div class="row">
                    <div class="col-2">
                        <h4>Contacts</h4>
                    </div>
                </div>
            </div>
        </div>
<!--        <div>-->
<!--            CSRF Token: <span th:text="${_csrf.token}"></span>-->
<!--        </div>-->
<!--        <div>-->
<!--            Logged-in Username: <span th:text="${#authentication.principal.username}"></span>-->
<!--        </div>-->
        <div class="row mt-2">
            <div class="col-8">
                <div class="input-group mb-1">
                    <div class="col-11">
                        <input type="text" class="form-control" placeholder="Search User" aria-label="Search"
                               aria-describedby="search-icon">
                    </div>
                    <div class="col-1" >
                        <div class="center-content">
                            <button class="btn btn-outline-primary text-center" type="button" id="search-icon">
                                <i class="bi bi-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-4 text-right">
                <button class="btn btn-success" onclick="filterContacts('online')">Online</button>
                <button class="btn btn-danger" onclick="filterContacts('offline')">Offline</button>
                <button class="btn btn-primary" id="addContactButton">Add Contact</button>
            </div>
        </div>
        <div class="row mt-2">
            <div id="user-contacts-container" class="col-6 contact-list-section">
                <!-- Your contact list items go here -->
                <div th:each="contact : ${contacts}">
                    <div class="row mt-1 p-1">
                        <div class="col-1">
                            <img src="https://uxwing.com/wp-content/themes/uxwing/download/peoples-avatars/default-profile-picture-grey-male-icon.png" alt="Avatar" class="avatar"> <!-- Avatar -->
                        </div>
                        <div class="col-5">
                            <div class="pl-10">
                                <!--  icon for offline user <i class="fas fa-circle text-danger"></i>-->
                                <i class="fas fa-circle text-success"></i>
                                <strong th:text="${contact.firstName + ' ' + contact.lastName}"> <i class="fas fa-circle text-success"></i> </strong>
                                <p>Last message goes here</p> <!-- Last message content -->
                            </div>
                        </div>
                        <div class="col-6 text-right">
                            <button class="btn btn-light"><i class="bi bi-chat-left-fill mr-5"></i>Chat</button>
                            <button class="btn btn-info" th:attr="onclick='showContactInfo(\'' + ${contact.id} + '\')'"><i class="bi bi-info-circle-fill mr-5"></i>Info</button>
                            <button class="btn btn-danger" th:attr="onclick='deleteContact(\'' + ${contact.id} + '\')'"><i class="bi bi-trash-fill mr-5"></i>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="row" id="userDetailInfo"></div>
            </div>
        </div>
    </div>

    <!--  add contacts list  -->
    <div id="add-contact-list">
        <div class="row">
            <div class="col-12">
                <div class="row">
                    <div class="col-2">
                        <h4>Global Contacts</h4>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mt-2">
            <div class="col-8">
                <div class="input-group mb-1">
                    <div class="col-11">
                        <input type="text" class="form-control" placeholder="Search Global User" aria-label="Search"
                               aria-describedby="search-icon">
                    </div>
                    <div class="col-1" >
                        <div class="center-content">
                            <button class="btn btn-outline-primary text-center" type="button" id="global-search-icon">
                                <i class="bi bi-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-4 text-right">
                <button class="btn btn-success">Add</button>
                <button class="btn btn-danger" id="cancelContactAdditionButton">Cancel</button>
            </div>
        </div>
        <div class="row mt-2">
            <div id="global-users-container" class="col-6 contact-list-section">
                <!-- Your contact list items go here -->
            </div>
            <div class="col-6 row" id="globalUserInfoSection">
            </div>
        </div>
    </div>
</div>
</body>
</html>

